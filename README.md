# R-tree ç©ºé—´ç´¢å¼•å®ç°ä¸å¯è§†åŒ–

ä¸€ä¸ªåŸºäº Rust çš„ R-tree ç©ºé—´ç´¢å¼•æ•°æ®ç»“æ„å®ç°ï¼Œä¸¥æ ¼éµå¾ª Gut84.pdf è®ºæ–‡æ ‡å‡†ï¼ŒåŒ…å«å®Œæ•´çš„å¯è§†åŒ–ç³»ç»Ÿã€‚

## ğŸŒŸ é¡¹ç›®ç‰¹ç‚¹

- **ä¸¥æ ¼çš„å­¦æœ¯å®ç°**ï¼šå®Œå…¨æŒ‰ç…§ Gut84.pdf è®ºæ–‡å®ç°äºŒæ¬¡åˆ†è£‚ç®—æ³•
- **å®Œæ•´çš„åŠŸèƒ½æ”¯æŒ**ï¼šæ’å…¥ã€æœç´¢ã€åˆ é™¤ã€èŠ‚ç‚¹åˆ†è£‚ã€æ ‘å‹ç¼©
- **å¯è§†åŒ–ç³»ç»Ÿ**ï¼šç›´è§‚å±•ç¤º R-tree çš„ç©ºé—´åˆ†å¸ƒå’Œæ ‘ç»“æ„
- **ä¸°å¯Œçš„æµ‹è¯•æ•°æ®**ï¼šå¤šç§åˆ†å¸ƒæ¨¡å¼çš„ç¤ºä¾‹æ•°æ®é›†
- **é«˜è´¨é‡ä»£ç **ï¼š32ä¸ªå•å…ƒæµ‹è¯•ï¼Œ100% æµ‹è¯•é€šè¿‡ç‡

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
rtree/
â”œâ”€â”€ src/                         # ğŸ¦€ Rust æ ¸å¿ƒå®ç°
â”‚   â”œâ”€â”€ lib.rs                   # åº“å…¥å£
â”‚   â”œâ”€â”€ rtree.rs                 # R-tree ä¸»ç»“æ„
â”‚   â”œâ”€â”€ node.rs                  # èŠ‚ç‚¹ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ rectangle.rs             # çŸ©å½¢å‡ ä½•æ“ä½œ
â”‚   â””â”€â”€ algorithms.rs            # æ ¸å¿ƒç®—æ³•å®ç°
â”œâ”€â”€ examples/                    # ğŸ“Š ç¤ºä¾‹ç¨‹åº
â”‚   â””â”€â”€ generate_json.rs         # JSON æ•°æ®ç”Ÿæˆå™¨
â”œâ”€â”€ visualization/               # ğŸ¨ å¯è§†åŒ–ç³»ç»Ÿ
â”‚   â”œâ”€â”€ example_data/            # ğŸ“„ æµ‹è¯•æ•°æ®é›†
â”‚   â”‚   â”œâ”€â”€ simple_tree.json     # ç®€å•ç½‘æ ¼åˆ†å¸ƒ (20ç‚¹)
â”‚   â”‚   â”œâ”€â”€ uniform_data.json    # å‡åŒ€åˆ†å¸ƒ (20ç‚¹)
â”‚   â”‚   â”œâ”€â”€ complex_tree.json    # å¤æ‚èšé›†åˆ†å¸ƒ (24ç‚¹)
â”‚   â”‚   â””â”€â”€ clustered_data.json  # èšç±»+å™ªå£°åˆ†å¸ƒ (28ç‚¹)
â”‚   â””â”€â”€ web/                     # ğŸŒ å‰ç«¯ç•Œé¢
â”‚       â”œâ”€â”€ index.html           # ä¸»é¡µé¢
â”‚       â”œâ”€â”€ style.css            # æ ·å¼æ–‡ä»¶
â”‚       â””â”€â”€ rtree-visualizer.js  # å¯è§†åŒ–å¼•æ“
â”œâ”€â”€ docs/                        # ğŸ“š é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ context_md/              # å¼€å‘å†ç¨‹æ–‡æ¡£
â””â”€â”€ README.md                    # ğŸ“– é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Rust 1.70+ 
- ç°ä»£æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariã€Edgeï¼‰

### 2. è¿è¡Œæµ‹è¯•

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd rtree

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¾“å‡º
cargo test -- --nocapture
```

### 3. ç”Ÿæˆå¯è§†åŒ–æ•°æ®

```bash
# ç”Ÿæˆç¤ºä¾‹æ•°æ®
cargo run --example generate_json

# æ£€æŸ¥ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶
ls visualization/example_data/
```

## ğŸ¨ å¯è§†åŒ–ç³»ç»Ÿä½¿ç”¨

### æ–¹å¼1ï¼šç›´æ¥æ‰“å¼€ï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. **æ‰“å¼€ç•Œé¢**ï¼š
   ```bash
   # ç›´æ¥ç”¨æµè§ˆå™¨æ‰“å¼€
   open visualization/web/index.html
   # æˆ–è€…åŒå‡»è¯¥æ–‡ä»¶
   ```

2. **åŠ è½½æ•°æ®**ï¼š
   - å¤åˆ¶ `visualization/example_data/` ä¸­ä»»æ„ JSON æ–‡ä»¶çš„å†…å®¹
   - ç²˜è´´åˆ°ç½‘é¡µçš„"JSONæ•°æ®è¾“å…¥"æ–‡æœ¬æ¡†
   - ç‚¹å‡»"åŠ è½½æ•°æ®"æŒ‰é’®

3. **åŠŸèƒ½é™åˆ¶**ï¼š
   - âœ… åŸºç¡€å¯è§†åŒ–åŠŸèƒ½å®Œå…¨æ­£å¸¸
   - âœ… æ‰‹åŠ¨æ•°æ®è¾“å…¥æ­£å¸¸
   - âŒ ç¤ºä¾‹æ•°æ®æŒ‰é’®æ— æ³•ä½¿ç”¨ï¼ˆæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼‰

### æ–¹å¼2ï¼šHTTPæœåŠ¡å™¨ï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰

1. **å¯åŠ¨æœåŠ¡å™¨**ï¼ˆé€‰æ‹©ä¸€ç§æ–¹å¼ï¼‰ï¼š

   **Pythonï¼ˆæ¨èï¼‰**ï¼š
   ```bash
   cd visualization/web
   python3 -m http.server 8000
   ```

   **Node.js**ï¼š
   ```bash
   npm install -g http-server
   cd visualization/web
   http-server -p 8000
   ```

   **Rust**ï¼š
   ```bash
   cargo install basic-http-server
   cd visualization/web
   basic-http-server .
   ```

2. **æ‰“å¼€ç•Œé¢**ï¼š
   ```bash
   # æµè§ˆå™¨è®¿é—®
   open http://localhost:8000
   ```

3. **å®Œæ•´åŠŸèƒ½**ï¼š
   - âœ… æ‰€æœ‰å¯è§†åŒ–åŠŸèƒ½
   - âœ… ç¤ºä¾‹æ•°æ®ä¸€é”®åŠ è½½
   - âœ… å®Œæ•´çš„äº¤äº’ä½“éªŒ

### ğŸ® ç•Œé¢æ“ä½œæŒ‡å—

#### æ•°æ®åŠ è½½
- **ç¤ºä¾‹æ•°æ®æŒ‰é’®**ï¼šä¸€é”®åŠ è½½é¢„ç½®çš„æµ‹è¯•æ•°æ®
- **æ‰‹åŠ¨è¾“å…¥**ï¼šå¤åˆ¶ç²˜è´´ JSON æ•°æ®åˆ°è¾“å…¥æ¡†

#### è§†å›¾æ§åˆ¶
- **é¼ æ ‡æ»šè½®**ï¼šç¼©æ”¾è§†å›¾
- **é¼ æ ‡æ‹–æ‹½**ï¼šå¹³ç§»è§†å›¾
- **é‡ç½®è§†å›¾æŒ‰é’®**ï¼šæ¢å¤åˆ°æœ€ä½³è§†å›¾

#### é”®ç›˜å¿«æ·é”®
- **Ré”®**ï¼šé‡ç½®è§†å›¾
- **+/-é”®**ï¼šæ”¾å¤§/ç¼©å°
- **æ–¹å‘é”®**ï¼šç²¾ç¡®å¹³ç§»è§†å›¾

#### æ˜¾ç¤ºé€‰é¡¹
- **æ˜¾ç¤ºæ•°æ®ç‚¹**ï¼šåˆ‡æ¢æ•°æ®ç‚¹çš„æ˜¾ç¤º
- **æ˜¾ç¤ºMBR**ï¼šåˆ‡æ¢æœ€å°è¾¹ç•ŒçŸ©å½¢çš„æ˜¾ç¤º
- **æ˜¾ç¤ºæ ‘ç»“æ„**ï¼šåˆ‡æ¢å³ä¾§æ ‘ç»“æ„å›¾

## ğŸ“Š ç¤ºä¾‹æ•°æ®é›†è¯´æ˜

| æ•°æ®é›† | æ•°æ®ç‚¹æ•° | åˆ†å¸ƒæ¨¡å¼ | é€‚ç”¨åœºæ™¯ |
|--------|----------|----------|----------|
| `simple_tree.json` | 20ä¸ª | ç½‘æ ¼åˆ†å¸ƒ | åˆå­¦è€…ï¼Œç†è§£åŸºæœ¬åˆ†å‰² |
| `uniform_data.json` | 20ä¸ª | å‡åŒ€åˆ†å¸ƒ | è§‚å¯Ÿè§„æ•´çš„æ ‘ç»“æ„ |
| `complex_tree.json` | 24ä¸ª | åŒºåŸŸèšé›† | ç†è§£å¤šå±‚ç´¢å¼•å…³ç³» |
| `clustered_data.json` | 28ä¸ª | èšé›†+å™ªå£° | ç ”ç©¶çœŸå®æ•°æ®æ¨¡å¼ |

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ ¸å¿ƒç®—æ³•**ï¼šåœ¨ `src/algorithms.rs` ä¸­å®ç°
2. **æ•°æ®ç»“æ„**ï¼šä¿®æ”¹ `src/node.rs` æˆ– `src/rtree.rs`
3. **å¯è§†åŒ–**ï¼šæ‰©å±• `visualization/web/rtree-visualizer.js`

### ç”Ÿæˆæ–°çš„æµ‹è¯•æ•°æ®

```rust
// ç¼–è¾‘ examples/generate_json.rs
fn generate_custom_data() -> RTree {
    let mut rtree = RTree::new(4);
    // æ·»åŠ æ‚¨çš„æ•°æ®ç‚¹
    rtree.insert(Rectangle::new(x, y, x+w, y+h), data);
    rtree
}
```

### è¿è¡Œç‰¹å®šæµ‹è¯•

```bash
# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test test_insert

# è¿è¡Œcondense_treeç›¸å…³æµ‹è¯•
cargo test condense_tree

# æ˜¾ç¤ºæµ‹è¯•è¾“å‡º
cargo test test_insert -- --nocapture
```

## ğŸ“ˆ æ€§èƒ½ç‰¹å¾

- **æ’å…¥å¤æ‚åº¦**ï¼šO(log n) å¹³å‡æƒ…å†µ
- **æœç´¢å¤æ‚åº¦**ï¼šO(log n) ç‚¹æŸ¥è¯¢ï¼ŒO(m) èŒƒå›´æŸ¥è¯¢
- **åˆ é™¤å¤æ‚åº¦**ï¼šO(log n) å¹³å‡æƒ…å†µ
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)
- **é€‚ç”¨è§„æ¨¡**ï¼šå½“å‰å®ç°é€‚åˆ < 10,000 èŠ‚ç‚¹çš„ä¸­å°è§„æ¨¡åº”ç”¨

## ğŸ“ ç®—æ³•å®ç°ç»†èŠ‚

### æ ¸å¿ƒç®—æ³•
- **æ’å…¥ç®—æ³•**ï¼šä¸¥æ ¼éµå¾ªè®ºæ–‡ Algorithm Insert
- **åˆ†è£‚ç®—æ³•**ï¼šäºŒæ¬¡åˆ†è£‚ (Quadratic Split)
  - PickSeedsï¼šé€‰æ‹©æœ€å·®çš„ç§å­å¯¹
  - PickNextï¼šé€‰æ‹©æœ€é€‚åˆåˆ†é…çš„æ¡ç›®
- **åˆ é™¤ç®—æ³•**ï¼šåŒ…å«èŠ‚ç‚¹ä¸‹æº¢å¤„ç†å’Œæ ‘å‹ç¼©
- **æœç´¢ç®—æ³•**ï¼šé€’å½’æœç´¢ï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢

### æµ‹è¯•è¦†ç›–
- **32ä¸ªå•å…ƒæµ‹è¯•**ï¼Œè¦†ç›–æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- **ä¸“é¡¹æµ‹è¯•**ï¼šcondense_treeã€åˆ†è£‚ç®—æ³•ã€MBRæ›´æ–°
- **è¾¹ç•Œæƒ…å†µæµ‹è¯•**ï¼šç©ºæ ‘ã€å•èŠ‚ç‚¹ã€ä¸‹æº¢ç­‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ™ è‡´è°¢

- åŸºäº Gut84.pdf è®ºæ–‡çš„ç»å…¸ R-tree ç®—æ³•
- æ„Ÿè°¢å¼€æºç¤¾åŒºçš„è´¡çŒ®å’Œæ”¯æŒ

---

**å¿«é€Ÿä½“éªŒ**ï¼šç›´æ¥æ‰“å¼€ `visualization/web/index.html`ï¼Œå¤åˆ¶ `visualization/example_data/simple_tree.json` çš„å†…å®¹è¿›è¡Œä½“éªŒï¼
